{% extends "base.html" %}
{% load static %}
{% load role_tags %}
{% block title %}Announcement Dashboard{% endblock %}

{% block content %}
<h2>Announcement Dashboard â€“ {{ today }}</h2>
{% if user|has_group:"Secretary" %}
            <a href="{% url 'members:add_announcement' %}" class="btn-primary">â• Add Announcement</a>
        {% endif %}
<!--<form method="post">
    {% csrf_token %}
    <input type="text" name="title" placeholder="Announcement title" required>
    <textarea name="message" placeholder="Announcement message" required></textarea>
    <button type="submit">Add Announcement</button>
</form> -->
<div class="table-container">
<table class="data-table">
    <thead>
        <tr>
            <th>Title</th>
            <th>Message</th>
            <th>Created At</th>
            {% if user|has_group:"Secretary" %}
                <th>Actions</th>
            {% endif %}
        </tr>
    </thead>
    <tbody>
{% for ann in announcements %}
    <tr>
        <td>{{ ann.title }}</td>
        <td>{{ ann.message }}</td>
        <td>{{ ann.created_at|date:"M d, Y H:i" }}</td>

        {% if user|has_group:"Secretary" %}
        <td>
            <a href="{% url 'members:announcement_edit' ann.id %}">âœï¸ Edit</a>

            <form method="post"
                  action="{% url 'members:announcement_delete' ann.id %}"
                  style="display:inline;">
                {% csrf_token %}
                <button type="submit"
                    onclick="return confirm('Are you sure you want to delete this announcement?');">
                    ğŸ—‘ï¸ Delete
                </button>
            </form>
        </td>
        {% endif %}
    </tr>
{% empty %}
    <tr>
        <td colspan="4">No announcements found.</td>
    </tr>
{% endfor %}
</tbody>
</table>
</div>

<hr>

<h3>Today's Announcements</h3>
<ul>
    {% for ann in announcements %}
        <li>
            <strong>{{ ann.title }}</strong><br>
            {{ ann.message }}
        </li>
    {% empty %}
        <li>No announcements yet.</li>
    {% endfor %}
</ul>

<hr>

<a href="{% url 'members:announcement_display' %}" target="_blank">
    <button style="font-size:18px;">ğŸ“º Open Extended Display</button>
</a>
<a href="{% url 'members:announcement_slide_show' %}" target="_blank">
    <button style="font-size:18px;">ğŸ“º Open Slideshow  Display</button>
</a>
{% endblock %}
