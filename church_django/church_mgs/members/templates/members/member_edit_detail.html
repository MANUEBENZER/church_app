{% extends "base.html" %}
{% load static %}
{% load role_tags %}

{% block title %}Edit Member | {{ member.full_name }}{% endblock %}

{% block content %}
<div class="container">

    <!-- ===== HEADER ===== -->
    <div class="page-header">
        <div>
            <h2>Edit Member</h2>
            <p class="text-muted">Update church member information</p>
        </div>

        <div class="status-badge">
            {% if member.is_active %}
                <span class="badge badge-success">Active</span>
            {% else %}
                <span class="badge badge-danger">Inactive</span>
            {% endif %}
        </div>
    </div>

    <form method="POST" enctype="multipart/form-data" class="member-form">
        {% csrf_token %}

        <!-- ================= BASIC INFO ================= -->
        <div class="card">

            <div class="card-header">
                <h3>Basic Information</h3>
            </div>

            <div class="profile-row">
                <!-- PHOTO -->
                <div class="photo-section">
                    {% if member.photo %}
                        <img src="{{ member.photo.url }}" class="avatar">
                    {% else %}
                        <img src="{% static 'img/avatar.png' %}" class="avatar">
                    {% endif %}
                    <label class="photo-label">Change Photo</label>
                    {{ form.photo }}
                </div>

                <!-- FORM -->
                <div class="form-grid">
                    <div class="form-group">
                        <label>Membership ID</label>
                        {{ form.membership_id }}
                    </div>

                    <div class="form-group">
                        <label>Full Name</label>
                        {{ form.full_name }}
                    </div>

                    <div class="form-group">
                        <label>Gender</label>
                        {{ form.gender }}
                    </div>

                    <div class="form-group">
                        <label>Date of Birth</label>
                        {{ form.date_of_birth }}
                    </div>
                </div>
            </div>
        </div>

        <!-- ================= CHURCH INFO ================= -->
        <div class="card">
            <h3>Church Information</h3>

            <div class="form-grid">
                <div class="form-group">
                    <label>Department</label>
                    {{ form.department }}
                </div>

                <div class="form-group">
                    <label>Position</label>
                    {{ form.position }}
                </div>

                <div class="form-group checkbox-group">
                    <label>
                        {{ form.baptized }} Baptized
                    </label>
                </div>
            </div>
        </div>

        <!-- ================= CONTACT INFO ================= -->
        <div class="card">
            <h3>Contact Information</h3>

            <div class="form-grid">
                <div class="form-group">
                    <label>Phone</label>
                    {{ form.phone }}
                </div>

                <div class="form-group">
                    <label>Email</label>
                    {{ form.email }}
                </div>

                <div class="form-group full-width">
                    <label>Address</label>
                    {{ form.address }}
                </div>

                <div class="form-group full-width">
                    <label>Emergency Contact</label>
                    {{ form.emergency_contact }}
                </div>
            </div>
        </div>

        <!-- ================= STATUS ================= -->
        <div class="card">
            <h3>Status</h3>

            <div class="checkbox-group">
                <label>
                    {{ form.is_active }} Active Member
                </label>
            </div>
        </div>

        <!-- ================= ACTIONS ================= -->
        <div class="form-actions">
            <a href="{% url 'members:member_detail' member.id %}" class="btn btn-light">
                ‚Üê Back to Profile
            </a>

            <div>
                <a href="{% url 'members:member_list' %}" class="btn btn-secondary">
                    Cancel
                </a>

                <button type="submit" class="btn btn-primary">
                    üíæ Update Member
                </button>
            </div>
        </div>

    </form>
</div>
{% endblock %}
